{"version":3,"file":"floodgate.dev.js","sources":["../src/functions.tsx","../src/index.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { FloodgateProps } from \"./types\";\n\nconst generator = function* generator(\n\tdata: FloodgateProps['data'],\n\tyieldLength: FloodgateProps['increment'],\n\tinitialYieldLength: FloodgateProps['initial']\n): Generator {\n\tlet currentIndex: number = 0;\n\twhile (currentIndex <= data.length - 1) {\n\t\tlet firstYield = currentIndex === 0;\n\t\tyield [...data].splice(\n\t\t\tcurrentIndex,\n\t\t\tfirstYield && initialYieldLength >= 0 ? initialYieldLength : yieldLength\n\t\t);\n\t\tcurrentIndex =\n\t\t\tfirstYield && initialYieldLength >= 0\n\t\t\t\t? currentIndex + initialYieldLength\n\t\t\t\t: currentIndex + yieldLength;\n\t}\n};\n\nconst ErrorMessage = ({\n\tchildren,\n\tcallerDisplayName,\n\ttext,\n\t...rest\n}: {\n\tchildren?: Array<any>,\n\tcallerDisplayName?: string,\n\ttext: string\n}): any => (\n\t<span\n\t\tclassName={`error_message${callerDisplayName ? `--${callerDisplayName}` : ''} : \"\"}`}\n\t\t{...rest}\n\t>\n\t\t{text ? text : children}\n\t</span>\n);\n\nexport { ErrorMessage, generator };\n","// @flow\nimport { FloodgateProps, FloodgateState } from \"./types\";\nimport * as _Polyfill from \"babel-polyfill\";\nimport * as React from \"react\";\nimport * as PropTypes from \"prop-types\";\nimport { generator } from \"./functions\";\n\nclass Floodgate extends React.Component<FloodgateProps, FloodgateState> {\n  // types\n  data: Array<any>;\n  queue: Generator;\n  state: FloodgateState;\n\n  // static props\n  static propTypes = {\n    children: PropTypes.func,\n    data: PropTypes.array.isRequired,\n    initial: PropTypes.number,\n    increment: PropTypes.number\n  };\n  static defaultProps = {\n    initial: 5,\n    increment: 5\n  };\n\n  // methods\n  constructor(props: FloodgateProps) {\n    super(props);\n    const { data, increment, initial } = props;\n    this.queue = generator(data, increment, initial);\n    this.data = data;\n    this.state = {\n      renderedItems: [],\n      allItemsRendered: false\n    };\n    this.loadAll = this.loadAll.bind(this);\n    this.loadNext = this.loadNext.bind(this);\n    this.reset = this.reset.bind(this);\n  }\n  componentDidMount(): void {\n    this.loadNext();\n  }\n  reset({ callback }: { callback?: Function } = {}): void {\n    this.queue = generator(this.data, this.props.increment, this.props.initial);\n    this.setState(\n      prevState => ({\n        renderedItems: [],\n        allItemsRendered: false\n      }),\n      () => this.loadNext({ callback })\n    );\n  }\n  loadAll(\n    {\n      callback,\n      suppressWarning\n    }: { callback?: Function, suppressWarning: boolean } = {\n      suppressWarning: false\n    }\n  ): void {\n    (!this.state.allItemsRendered &&\n      this.setState(prevState => {\n        return {\n          renderedItems: this.data,\n          allItemsRendered: true\n        };\n      }, () => callback && callback(this.state))) ||\n      (this.state.allItemsRendered &&\n        !suppressWarning &&\n        console.warn(\"Floodgate: All items are rendered\"));\n  }\n  loadNext({ callback }: { callback?: Function } = {}): void {\n    !this.state.allItemsRendered &&\n      this.setState(prevState => {\n        // Get next iteratable\n        const { value, done } = this.queue.next();\n        // Check if array value exists and has at least one element\n        const valueIsAvailable: boolean =\n          value !== null && value !== undefined && value.length > 0;\n        // Combine new items with rendered items from state\n        const newRenderedData = [\n          ...prevState.renderedItems,\n          ...(valueIsAvailable ? value : [])\n        ];\n        // Check if all data items have been rendered\n        const dataLengthMatches: boolean =\n          newRenderedData.length === this.data.length;\n\n        return {\n          renderedItems: newRenderedData,\n          allItemsRendered:\n            !valueIsAvailable || (valueIsAvailable && dataLengthMatches)\n              ? true\n              : false\n        };\n      }, () => callback && callback(this.state));\n  }\n  render() {\n    const { loadAll, loadNext, reset } = this;\n    const { renderedItems, allItemsRendered } = this.state;\n    return this.props.children({\n      items: renderedItems,\n      loadComplete: allItemsRendered,\n      loadAll,\n      loadNext,\n      reset\n    });\n  }\n}\n\nexport default Floodgate;\n"],"names":["generator","data","yieldLength","initialYieldLength","currentIndex","length","splice","firstYield","Floodgate","props","increment","initial","queue","state","loadAll","bind","loadNext","reset","callback","setState","suppressWarning","allItemsRendered","console","warn","next","value","valueIsAvailable","undefined","newRenderedData","prevState","renderedItems","dataLengthMatches","children","React","PropTypes","isRequired"],"mappings":"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"}